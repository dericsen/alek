<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chinese New Year - Hidden Object Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #8B0000 0%, #DC143C 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }

        .game-container {
            width: 90vw;
            max-width: 1200px;
            height: 90vh;
            max-height: 800px;
            background: #FFF8DC;
            border: 8px solid #FFD700;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(90deg, #DC143C 0%, #8B0000 100%);
            color: #FFD700;
            padding: 20px;
            text-align: center;
            border-bottom: 4px solid #FFD700;
        }

        .header h1 {
            font-size: 2.5em;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
            margin-bottom: 10px;
        }

        .credits-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #FFD700;
            color: #DC143C;
            border: 3px solid #DC143C;
            padding: 10px 20px;
            font-size: 1em;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            z-index: 100;
        }

        .credits-btn:hover {
            background: #FFA500;
            transform: scale(1.05);
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
        }

        .progress-info {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
        }

        .progress-info div {
            font-size: 1.2em;
            font-weight: bold;
            padding: 5px 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            margin: 5px;
        }

        .game-scene {
            width: 100%;
            height: calc(100% - 160px);
            position: relative;
            background-size: cover;
            background-position: center;
            cursor: crosshair;
        }

        /* Level 1 - Angpao Scene */
        .scene-level1 {
            background-image: url('images/bg1.new.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        /* Level 2 - Koin Scene */
        .scene-level2 {
            background-image: url('images/bg2.new.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        /* Level 3 - kue-keranjang Scene */
        .scene-level3 {
            background-image: url('images/bg3.new.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        /* Dekorasi scene */
        .lantern {
            position: absolute;
            width: 60px;
            height: 80px;
            background: radial-gradient(circle, #FF0000 0%, #8B0000 100%);
            border-radius: 50% 50% 40% 40%;
            border: 3px solid #FFD700;
            animation: swing 3s ease-in-out infinite;
        }

        .lantern::after {
            content: 'Á¶è';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #FFD700;
            font-size: 24px;
            font-weight: bold;
        }

        @keyframes swing {

            0%,
            100% {
                transform: rotate(-5deg);
            }

            50% {
                transform: rotate(5deg);
            }
        }

        .firework {
            position: absolute;
            width: 40px;
            height: 40px;
            background: radial-gradient(circle, #FFD700 0%, transparent 70%);
            border-radius: 50%;
            animation: sparkle 2s ease-in-out infinite;
        }

        @keyframes sparkle {

            0%,
            100% {
                opacity: 0.3;
                transform: scale(0.8);
            }

            50% {
                opacity: 1;
                transform: scale(1.2);
            }
        }

        /* Hidden Objects */
        .hidden-object {
            position: absolute;
            cursor: pointer;
            transition: all 0.3s ease;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.3));
            z-index: 5;
        }

        .hidden-object:hover {
            transform: scale(1.1);
            filter: drop-shadow(0 0 10px #FFD700);
            z-index: 15;
        }

        .hidden-object.found {
            animation: fadeOut 0.5s ease-out forwards;
            pointer-events: none;
        }

        @keyframes fadeOut {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.3) rotate(10deg);
                opacity: 0.7;
            }

            100% {
                transform: scale(0);
                opacity: 0;
            }
        }

        /* Angpao styling */
        .angpao {
            width: 50px;
            height: 70px;
            background: linear-gradient(135deg, #FF0000 0%, #DC143C 100%);
            border: 2px solid #FFD700;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #FFD700;
            font-weight: bold;
        }

        /* Koin styling */
        .koin {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, #FFD700 0%, #FFA500 100%);
            border: 3px solid #8B4513;
            border-radius: 50%;
            position: relative;
        }

        .koin::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 30px;
            height: 30px;
            border: 2px solid #8B4513;
            border-radius: 3px;
        }

        /* kue-keranjang styling */
        .kue-keranjang {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #D2691E 0%, #FFB347 100%);
            border-radius: 10%;
            border: 2px solid #8B4513;
            position: relative;
            box-shadow: inset -2px -2px 5px rgba(0, 0, 0, 0.2);
        }

        .kue-keranjang::after {
            content: '';
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 25px;
            height: 12px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 50%;
        }

        /* Modal */
        .modal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            padding: 40px;
            border-radius: 20px;
            border: 5px solid #DC143C;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            max-width: 600px;
        }

        .modal.show {
            display: block;
            animation: modalPop 0.5s ease-out;
        }

        @keyframes modalPop {
            0% {
                transform: translate(-50%, -50%) scale(0);
            }

            50% {
                transform: translate(-50%, -50%) scale(1.1);
            }

            100% {
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .modal h2 {
            color: #DC143C;
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .modal p {
            color: #8B0000;
            font-size: 1.2em;
            line-height: 1.6;
            margin-bottom: 25px;
            text-align: left;
        }

        .modal button {
            background: #DC143C;
            color: #FFD700;
            border: none;
            padding: 15px 40px;
            font-size: 1.3em;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .modal button:hover {
            background: #8B0000;
            transform: scale(1.05);
        }

        .object-icon {
            font-size: 4em;
            margin-bottom: 15px;
        }

        /* Credits Modal Styling */
        .credits-container {
            display: flex;
            justify-content: space-around;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .credit-person {
            text-align: center;
            flex: 1;
            min-width: 200px;
        }

        .credit-photo {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 5px solid #DC143C;
            object-fit: cover;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .credit-name {
            font-size: 1.5em;
            font-weight: bold;
            color: #DC143C;
            margin-bottom: 5px;
        }

        .credit-role {
            font-size: 1.1em;
            color: #8B0000;
            font-style: italic;
        }

        /* Obstacles - Objek Penghalang */
        .obstacle {
            position: absolute;
            pointer-events: none;
            z-index: 10;
        }

        /* Box - Kotak kado */
        .obstacle.box {
            background: linear-gradient(135deg, #FF6347 0%, #DC143C 100%);
            border: 3px solid #FFD700;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .obstacle.box::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 8px;
            background: #FFD700;
            transform: translateY(-50%);
        }

        .obstacle.box::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 8px;
            background: #FFD700;
            transform: translateX(-50%);
        }

        /* Plant - Tanaman hias */
        .obstacle.plant {
            background: none;
        }

        .obstacle.plant::before {
            content: 'üéã';
            font-size: 80px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            filter: drop-shadow(3px 3px 5px rgba(0, 0, 0, 0.3));
        }

        /* Vase - Vas bunga */
        .obstacle.vase {
            background: linear-gradient(180deg, #8B4513 0%, #A0522D 100%);
            border-radius: 20% 20% 40% 40%;
            border: 3px solid #654321;
            box-shadow: inset 0 5px 10px rgba(0, 0, 0, 0.3);
        }

        .obstacle.vase::before {
            content: 'üå∏';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 35px;
        }

        /* Drum - Gendang */
        .obstacle.drum {
            background: linear-gradient(90deg, #8B0000 0%, #DC143C 50%, #8B0000 100%);
            border-radius: 10px;
            border: 4px solid #FFD700;
            position: relative;
        }

        .obstacle.drum::before,
        .obstacle.drum::after {
            content: '';
            position: absolute;
            left: 10%;
            right: 10%;
            height: 4px;
            background: #FFD700;
        }

        .obstacle.drum::before {
            top: 30%;
        }

        .obstacle.drum::after {
            top: 60%;
        }

        /* Scroll - Gulungan kertas */
        .obstacle.scroll {
            background: linear-gradient(180deg, #F5DEB3 0%, #DEB887 100%);
            border-radius: 50px;
            border: 2px solid #8B4513;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }

        .obstacle.scroll::before {
            content: 'Á¶è';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 30px;
            color: #8B0000;
            font-weight: bold;
        }

        /* Basket - Keranjang */
        .obstacle.basket {
            background: linear-gradient(135deg, #D2691E 0%, #8B4513 100%);
            border-radius: 20% 20% 50% 50%;
            border: 3px solid #654321;
            position: relative;
            overflow: hidden;
        }

        .obstacle.basket::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 40%;
            background: repeating-linear-gradient(90deg,
                    #A0522D 0px,
                    #A0522D 8px,
                    #8B4513 8px,
                    #8B4513 16px);
        }

        /* Fan - Kipas */
        .obstacle.fan {
            background: radial-gradient(circle, #FFD700 0%, #FFA500 100%);
            border-radius: 50% 50% 10% 10%;
            border: 3px solid #DC143C;
            position: relative;
        }

        .obstacle.fan::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 60%;
            height: 60%;
            background: repeating-linear-gradient(45deg,
                    #FF0000 0px,
                    #FF0000 10px,
                    #FFD700 10px,
                    #FFD700 20px);
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        /* Teapot - Teko */
        .obstacle.teapot {
            background: linear-gradient(135deg, #B8860B 0%, #DAA520 100%);
            border-radius: 40% 40% 50% 50%;
            border: 3px solid #8B6914;
            position: relative;
        }

        .obstacle.teapot::before {
            content: '';
            position: absolute;
            top: 20%;
            right: -15px;
            width: 30px;
            height: 20px;
            background: #B8860B;
            border-radius: 0 50% 50% 0;
            border: 2px solid #8B6914;
            border-left: none;
        }

        .obstacle.teapot::after {
            content: '';
            position: absolute;
            top: 10%;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 25px;
            background: #B8860B;
            border-radius: 5px 5px 0 0;
            border: 2px solid #8B6914;
        }

        /* Plate - Piring */
        .obstacle.plate {
            background: radial-gradient(circle, #FFF 0%, #F0F0F0 70%, #DDD 100%);
            border-radius: 50%;
            border: 4px solid #FFD700;
            box-shadow: inset 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .obstacle.plate::before {
            content: 'üçä';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 40px;
        }

        /* Particle effect */
        .particle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #FFD700;
            border-radius: 50%;
            pointer-events: none;
            animation: particleFall 1s ease-out forwards;
        }

        @keyframes particleFall {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }

            100% {
                transform: translateY(100px) scale(0);
                opacity: 0;
            }
        }
    </style>
</head>

<body>
    <div class="game-container">
        <div class="header">
            <button class="credits-btn" id="creditsBtn">Credits</button>
            <h1>üßß Chinese New Year üßß</h1>
            <div class="progress-bar">
                <div class="progress-info">
                    <div>Level: <span id="currentLevel">1</span></div>
                    <div>Objek: <span id="objectType">Angpao</span></div>
                    <div>Ditemukan: <span id="foundCount">0</span>/<span id="totalCount">5</span></div>
                </div>
            </div>
        </div>

        <div class="game-scene" id="gameScene"></div>

        <!-- Modal Info Objek (muncul setelah level selesai) -->
        <div class="modal" id="objectInfoModal">
            <div class="object-icon" id="objectIcon">üßß</div>
            <h2 id="objectTitle">Angpao</h2>
            <p id="objectDescription">
                Angpao adalah amplop merah yang biasanya berisi uang dan diberikan saat Tahun Baru Imlek sebagai simbol keberuntungan dan berkah.
            </p>
            <button id="objectInfoNextBtn">Lanjutkan</button>
        </div>

        <!-- Modal Level Complete (sekarang tidak dipakai, langsung ke objectInfoModal) -->
        <div class="modal" id="levelCompleteModal">
            <h2>üéâ Level Selesai! üéâ</h2>
            <button id="nextLevelBtn">Lanjut ke Level Berikutnya</button>
        </div>

        <!-- Modal Game Complete -->
        <div class="modal" id="gameCompleteModal">
            <h2>üéä Selamat! üéä</h2>
            <p style="color: #DC143C; font-size: 1.5em; margin-bottom: 20px;">Anda telah menyelesaikan semua level!</p>
            <button id="restartBtn">Main Lagi</button>
        </div>

        <!-- Modal Credits -->
        <div class="modal" id="creditsModal">
            <h2>Credits</h2>
            <p style="color: #8B0000; font-size: 1.1em; margin-bottom: 20px;">Dikembangkan oleh:</p>
            <div class="credits-container">
                <div class="credit-person">
                    <img src="images/person1.jpeg" alt="Developer 1" class="credit-photo">
                    <div class="credit-name">Dericsen W</div>
                    <div class="credit-role">Developer</div>
                </div>
                <div class="credit-person">
                    <img src="images/person2.png" alt="Developer 2" class="credit-photo">
                    <div class="credit-name">Dr. Evawaty Tanuar, S.Kom., M.Comp.Sc</div>
                    <div class="credit-role">Project Mentor</div>
                </div>
            </div>
            <button id="closeCreditsBtn">Tutup</button>
        </div>
    </div>

    <script>
        // Audio context untuk efek suara
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(frequency = 800, duration = 0.1) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.frequency.value = frequency;
            oscillator.type = 'sine';

            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);
        }

        // Game state
        const gameState = {
            currentLevel: 1,
            foundObjects: 0,
            totalObjects: 5,
            levels: [
                {
                    level: 1,
                    objectType: 'Angpao',
                    objectClass: 'angpao',
                    objectContent: 'Á¶è',
                    objectIcon: 'üßß',
                    objectInfo: {
                        title: 'Angpao (Á∫¢ÂåÖ)',
                        description: 'Angpao atau Hong Bao adalah amplop merah yang berisi uang. Tradisi memberikan angpao melambangkan harapan baik, keberuntungan, dan berkah untuk tahun yang baru. Warna merah dipercaya dapat mengusir roh jahat dan membawa keberuntungan.'
                    },
                    sceneClass: 'scene-level1',
                    allPositions: [
                        { top: '35%', left: '20.8%', size: 0.2 },
                        { top: '71%', left: '63.5%', size: 0.2 },
                        { top: '73.3%', left: '20.1%', size: 0.2 },
                        { top: '78.7%', left: '3%', size: 0.4 },
                        { top: '9%', left: '74.5%', size: 0.2 },
                        { top: '14%', left: '38%', size: 0.2 },
                        { top: '20%', left: '68%', size: 0.2 },
                        { top: '55%', left: '53.5%', size: 0.2 },
                        { top: '65%', left: '27%', size: 0.17 },
                        { top: '60%', left: '35.5%', size: 0.2 },
                        { top: '68%', left: '66%', size: 0.2 },
                        { top: '68%', left: '92.55%', size: 0.25 },
                    ],
                    obstacles: []
                },
                {
                    level: 2,
                    objectType: 'Koin',
                    objectClass: 'koin',
                    objectContent: '',
                    objectIcon: 'ü™ô',
                    objectInfo: {
                        title: 'Koin Emas Tiongkok',
                        description: 'Koin emas kuno Tiongkok melambangkan kemakmuran dan kekayaan. Bentuknya yang bulat dengan lubang persegi di tengah mewakili filosofi "langit bulat, bumi persegi". Koin ini sering digantung sebagai jimat keberuntungan.'
                    },
                    sceneClass: 'scene-level2',
                    allPositions: [
                        { top: '5.5%', left: '14%', size: 0.15 },
                        { top: '68%', left: '3%', size: 0.15 },
                        { top: '47.5%', left: '6.2%', size: 0.15 },
                        { top: '27.4%', left: '65.27%', size: 0.15 },
                        { top: '9%', left: '64.5%', size: 0.15 },
                        { top: '12.5%', left: '34.6%', size: 0.15 },
                        { top: '48.5%', left: '85.3%', size: 0.15 },
                        { top: '89.5%', left: '20.9%', size: 0.15 },
                        { top: '61%', left: '73.2%', size: 0.15 },
                        { top: '61%', left: '24.45%', size: 0.15 },
                        { top: '13.8%', left: '74.3%', size: 0.15 },
                        { top: '0.6%', left: '14.2%', size: 0.15 },
                        { top: '24%', left: '10.3%', size: 0.15 },
                        { top: '58%', left: '69%', size: 0.15 },
                        { top: '36%', left: '58%', size: 0.15 }
                    ],
                    obstacles: []
                },
                {
                    level: 3,
                    objectType: 'Kue Keranjang',
                    objectClass: 'kue-keranjang',
                    objectContent: '',
                    objectIcon: 'ü•Æ',
                    objectInfo: {
                        title: 'Kue Keranjang (Âπ¥Á≥ï)',
                        description: 'Kue Keranjang atau Nian Gao adalah kue khas Imlek yang terbuat dari tepung beras ketan dan gula merah. "Nian Gao" dalam bahasa Mandarin terdengar seperti "tahun yang lebih tinggi", melambangkan harapan untuk kemajuan dan kesuksesan di tahun mendatang.'
                    },
                    sceneClass: 'scene-level3',
                    allPositions: [
                        { top: '18%', left: '18%', size: 0.2 },
                        { top: '25.5%', left: '2.5%', size: 0.175 },
                        { top: '22.6%', left: '41.6%', size: 0.18 },
                        { top: '29.7%', left: '30%', size: 0.19 },
                        { top: '44.99%', left: '25.2%', size: 0.2 },
                        { top: '36.5%', left: '54.5%', size: 0.17 },
                        { top: '71%', left: '44.8%', size: 0.2 },
                        { top: '71%', left: '32%', size: 0.19 },
                        { top: '70.5%', left: '76%', size: 0.21 },
                        { top: '77.5%', left: '19%', size: 0.18 },
                        { top: '88.9%', left: '4%', size: 0.2 },
                        { top: '83%', left: '89%', size: 0.22 },
                        { top: '52%', left: '96%', size: 0.19 },
                        { top: '10%', left: '70%', size: 0.21 },
                        { top: '37%', left: '90%', size: 0.18 }
                    ],
                    obstacles: []
                }
            ]
        };

        // DOM elements
        const gameScene = document.getElementById('gameScene');
        const currentLevelEl = document.getElementById('currentLevel');
        const objectTypeEl = document.getElementById('objectType');
        const foundCountEl = document.getElementById('foundCount');
        const totalCountEl = document.getElementById('totalCount');
        const objectInfoModal = document.getElementById('objectInfoModal');
        const objectIcon = document.getElementById('objectIcon');
        const objectTitle = document.getElementById('objectTitle');
        const objectDescription = document.getElementById('objectDescription');
        const objectInfoNextBtn = document.getElementById('objectInfoNextBtn');
        const levelCompleteModal = document.getElementById('levelCompleteModal');
        const gameCompleteModal = document.getElementById('gameCompleteModal');
        const nextLevelBtn = document.getElementById('nextLevelBtn');
        const restartBtn = document.getElementById('restartBtn');
        const creditsModal = document.getElementById('creditsModal');
        const creditsBtn = document.getElementById('creditsBtn');
        const closeCreditsBtn = document.getElementById('closeCreditsBtn');

        // Initialize game
        function initLevel() {
            const level = gameState.levels[gameState.currentLevel - 1];

            let positionsToUse = level.positions;
            if (Array.isArray(level.allPositions) && level.allPositions.length > 0) {
                const validPositions = level.allPositions.filter(pos =>
                    pos && pos.top && pos.left && !pos.top.includes('//') && !pos.left.includes('//')
                );

                if (validPositions.length < gameState.totalObjects) {
                    console.warn(`Level ${level.level}: Only ${validPositions.length} valid positions available, need ${gameState.totalObjects}`);
                }

                const pool = [...validPositions];

                for (let i = pool.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [pool[i], pool[j]] = [pool[j], pool[i]];
                }

                const countToSelect = Math.min(gameState.totalObjects, pool.length);
                positionsToUse = pool.slice(0, countToSelect);
                console.log(`Level ${level.level}: Selected ${positionsToUse.length} positions from ${validPositions.length} valid positions`);

                if (positionsToUse.length < gameState.totalObjects) {
                    console.error(`ERROR: Only ${positionsToUse.length} positions selected, expected ${gameState.totalObjects}`);
                }
            }

            gameState.foundObjects = 0;
            gameScene.innerHTML = '';

            currentLevelEl.textContent = gameState.currentLevel;
            objectTypeEl.textContent = level.objectType;
            foundCountEl.textContent = '0';
            totalCountEl.textContent = gameState.totalObjects;

            gameScene.className = 'game-scene ' + level.sceneClass;

            addDecorations();

            if (positionsToUse && positionsToUse.length > 0) {
                console.log(`Creating ${positionsToUse.length} objects for level ${level.level}`);
                positionsToUse.forEach((pos, index) => {
                    console.log(`Creating object ${index + 1} at ${pos.top}, ${pos.left}, size: ${pos.size}`);
                    createHiddenObject(level, pos, index);
                });
            } else if (level.positions && level.positions.length > 0) {
                level.positions.forEach((pos, index) => {
                    createHiddenObject(level, pos, index);
                });
            }

            if (level.obstacles) {
                level.obstacles.forEach(obstacle => {
                    createObstacle(obstacle);
                });
            }

            const objectCount = document.querySelectorAll('.hidden-object').length;
            console.log(`Level ${gameState.currentLevel}: ${objectCount} ${level.objectType} objects created (Expected: ${gameState.totalObjects})`);

            if (objectCount !== gameState.totalObjects) {
                console.error(`WARNING: Object count mismatch! Expected ${gameState.totalObjects}, got ${objectCount}`);
            }
        }

        function addDecorations() {
            const fireworkPositions = [
                { top: '10%', left: '50%' },
                { top: '20%', left: '30%' },
                { top: '15%', left: '75%' }
            ];

            fireworkPositions.forEach(pos => {
                const firework = document.createElement('div');
                firework.className = 'firework';
                firework.style.top = pos.top;
                firework.style.left = pos.left;
                gameScene.appendChild(firework);
            });
        }

        function createHiddenObject(level, position, index) {
            const obj = document.createElement('div');
            obj.className = `hidden-object ${level.objectClass}`;
            obj.style.top = position.top;
            obj.style.left = position.left;

            if (position.size && position.size !== 1) {
                obj.style.transform = `scale(${position.size})`;
            }

            obj.textContent = level.objectContent;
            obj.dataset.index = index;

            obj.addEventListener('click', function (e) {
                handleObjectClick(this, e);
            });

            gameScene.appendChild(obj);
        }

        function createObstacle(obstacle) {
            const obs = document.createElement('div');
            obs.className = `obstacle ${obstacle.type}`;
            obs.style.top = obstacle.top;
            obs.style.left = obstacle.left;
            obs.style.width = obstacle.width;
            obs.style.height = obstacle.height;

            gameScene.appendChild(obs);
        }

        function handleObjectClick(element, event) {
            if (element.classList.contains('found')) return;

            element.classList.add('found');
            gameState.foundObjects++;

            playSound(1000 + (gameState.foundObjects * 200), 0.2);
            createParticles(event.clientX, event.clientY);

            foundCountEl.textContent = gameState.foundObjects;

            if (gameState.foundObjects === gameState.totalObjects) {
                setTimeout(() => {
                    completeLevel();
                }, 500);
            }
        }

        function createParticles(x, y) {
            for (let i = 0; i < 10; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                particle.style.background = ['#FFD700', '#FF0000', '#FFA500'][Math.floor(Math.random() * 3)];
                document.body.appendChild(particle);

                setTimeout(() => {
                    particle.remove();
                }, 1000);
            }
        }

        function completeLevel() {
            playSound(1500, 0.3);

            // Tampilkan modal info objek terlebih dahulu
            const level = gameState.levels[gameState.currentLevel - 1];
            objectIcon.textContent = level.objectIcon;
            objectTitle.textContent = level.objectInfo.title;
            objectDescription.textContent = level.objectInfo.description;
            objectInfoModal.classList.add('show');
        }

        function nextLevel() {
            levelCompleteModal.classList.remove('show');
            gameState.currentLevel++;
            initLevel();
        }

        function restartGame() {
            gameCompleteModal.classList.remove('show');
            gameState.currentLevel = 1;
            initLevel();
        }

        // Event listener untuk tombol "Lanjutkan" di modal info objek
        objectInfoNextBtn.addEventListener('click', function() {
            objectInfoModal.classList.remove('show');
            
            // Cek apakah ini level terakhir
            if (gameState.currentLevel === gameState.levels.length) {
                // Tampilkan modal game complete
                gameCompleteModal.classList.add('show');
            } else {
                // Lanjut ke level berikutnya
                gameState.currentLevel++;
                initLevel();
            }
        });

        nextLevelBtn.addEventListener('click', nextLevel);
        restartBtn.addEventListener('click', restartGame);

        // Credits button functionality
        creditsBtn.addEventListener('click', function() {
            creditsModal.classList.add('show');
        });

        closeCreditsBtn.addEventListener('click', function() {
            creditsModal.classList.remove('show');
        });

        // Start game
        initLevel();
    </script>
</body>

</html>